<dom-module id="view-post">
  <template>

    <!-- this app-route determines the post to show -->
    <app-route
      route="{{route}}"
      pattern="/:post"
      data="{{routeData}}"
      tail="{{subroute}}"></app-route>

    <!-- post article -->
    <article>
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <!-- parse markdown -->
            <zero-md file="[[post]]" id="post">
              <style>
                .md-html h1 {
                  color: #0066b3;
                }
              </style>
              <div class="md-html" id="postHtml"></div>
            </zero-md>

            <!-- pager -->
            <ul class="pager">
                <li class="next" style="float:left;">
                    <a href="#/home"><i class="fa fa-long-arrow-left" aria-hidden="true"></i> Back</a>
                </li>
            </ul>
          </div>
        </div>
      </div>
    </article>

  </template>

  <script>
    Polymer({
      is: 'view-post',
      properties: {
        route: {
          type: Object,
          observer: '_routePageChanged'
        },
        post: {
          type: String,
          value: 'posts/post_1.md',
          reflectToAttribute: true
        }
      },
      observers: [
        '_routePageChanged(routeData)',
        '_viewChanged(routeData.view)'
      ],
      _viewChanged: function(view) {
        this.$.postHtml.innerHTML = this.$.postHtml.innerHTML;
      },
      _routePageChanged: function(routeData) {
        this.$.postHtml.innerHTML = this.$.postHtml.innerHTML;
        if (routeData.post) {
          this.post = 'posts/post_' + routeData.post + '.md';
          this.scrollIntoView();
          window.scrollBy(0, -50);
        }
      }
    });
  </script>
</dom-module>
